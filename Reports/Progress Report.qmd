---
title: "Replicating Sustainable youth employment quality management: The impact of robotization in China by Fucheng Liang and Yi Liu"
format: pdf
author: Jesse Brandt, Alyssa Langmeyer, Veena Seshadri
date: June 10, 2025
---
Load packages
```{r}
#| output: false
library(tidyverse)
library(readxl)
library(readr)
library(ExPanDaR)
library(lme4)
```

## Load the data (cleaned and truncated)

```{r}
robots <- read_csv("../Data/robots_cleaned.csv")
```

# Table 2: Summary Statistics.

```{r}
#select relevant columns
selected_variables <- robots %>%
  select(Quality, Robot, age, gender, marriage, health, lnGDP, structure, lnaverwage)
#get summary statistics
mapply(FUN = \(x) c(N = length(x), mean = mean(x), sd = sd(x), min = min(x), max = max(x)),
       selected_variables) %>%
  t()
```


```{r}
#| include: false
robots %>%
  summary()
```



# Table 3: Linear model.
Our results do not yet match theirs. Individual FE is unclear.


Mixed effects model (column 1)
```{r}
lmer(data = trunc.robots, formula = Quality ~ Robot + age + gender + marriage + health + lnGDP
     + structure + lnaverwage + as.factor(year)+ as.factor(province) + (1|id))
```


Fixed effects model (column 2)

```{r}
model1 <- lm(data = robots, formula = Quality ~ Robot + age + gender + marriage + health + lnGDP
   + structure + lnaverwage + as.factor(year) + as.factor(province))
model2 <- lm(data = robots, formula = Quality ~ Robot + age + gender + marriage + health + lnGDP + structure + lnaverwage)

model.1.summary <- summary(model1)
model.2.summary <- summary(model2)

#model including year FE and region FE
model.1.summary
#model without year FE and region FE
model.2.summary

#model including id - filtered to include only ids with more than one observation
duplicate_ids <- trunc.robots %>%
  group_by(id) %>%
  mutate(count = length(id)) %>%
  filter(count>1)

fe_model3 <- lm(data = duplicate_ids, formula = Quality ~ Robot + age + gender + marriage + health + lnGDP
                + structure + lnaverwage + as.factor(year) + as.factor(province) + as.factor(id))
model.3.summary <- summary(fe_model3)
model.3.summary$coefficients[1:9,1:4]
```


Random effects model (column 3)
Note: in the paper, column 3 is the same as column 1, but the text indicates that it should be the random effects model.
```{r}
lmer(data = trunc.robots, formula = Quality ~ Robot + age + gender + marriage + health + lnGDP
     + structure + lnaverwage + (1|year) + (1|province) + (1|id))
```



```{r}
#model 1 with province and year FE not shown
model.1.summary$coefficients[1:9,1:4]
model.3.summary$coefficients[1:9,1:4]
```

# Table 4: Results of endogeneity test and robustness test.


# Table 5: Heterogeneity analysis results.

# Table 6: Results of mechanism analysis.

# Table 7: Results of regulatory effect analysis.

# Table 8: Results of he effectiveness nalysis of employment promotion measures. 